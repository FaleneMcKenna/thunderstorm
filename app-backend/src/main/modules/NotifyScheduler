import {FirebaseScheduledFunction} from "@nu-art/firebase/backend-functions";
import {FirebaseFunctionModule,} from "@nu-art/firebase/backend-functions";
import {DB_Meas, DB_Tokens, TokenCollection, WithingsModule} from "./WithingsModule";
import {FirebaseModule} from "@nu-art/firebase/backend";
import {write} from "firebase-functions/lib/logger";
import {functions} from "firebase";

export class NotifyScheduler_Class
    extends FirebaseScheduledFunction {

    constructor() {
        super("scheduler for Notify");
        this.setSchedule('every 2 minutes');
    }

    // onScheduledEvent = async (): Promise<any> => {
    //     console.log("Upsert new collected Data");
    //     await WithingsModule.getMeasRequest('ir-qa-012');
    //     //const timerId = setInterval(() => WithingsModule.getMeasRequest('ir-qa-012'), 2000);
    //      return WithingsModule.getMeasRequest('ir-qa-012')
    // };
    onScheduledEvent = async (): Promise<any> => {
        console.log("Update Node to trigger the measurements");
        await functions.database.ref('/data/notify/update', "true");

    };
}

export const NotifyScheduler = new NotifyScheduler_Class();